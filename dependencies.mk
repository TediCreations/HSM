#-------------------------------------------------------------------------------
#	 _____                            _                 _           
#	|  __ \                          | |               (_)          
#	| |  | | ___ _ __   ___ _ __   __| | ___ _ __   ___ _  ___  ___ 
#	| |  | |/ _ \ '_ \ / _ \ '_ \ / _` |/ _ \ '_ \ / __| |/ _ \/ __|
#	| |__| |  __/ |_) |  __/ | | | (_| |  __/ | | | (__| |  __/\__ \
#	|_____/ \___| .__/ \___|_| |_|\__,_|\___|_| |_|\___|_|\___||___/
#	            | |                                                 
#	            |_|                                                 
#
#-------------------------------------------------------------------------------

################################################################################
################		STM32 core dependencies		############################
################################################################################

#-------------------------------------------------------------------------------
#						Micro-controller

CORE_ASM_SRCs =			$(SRC_DIR)sys/startup_stm32f072xb.s

#-------------------------------------------------------------------------------
#						STM32 CMSIS drivers

STM32_CMSIS_C_INCs =	-Ithirdparty/CMSIS/Device/ST/STM32F0xx/Include/\
						-Ithirdparty/CMSIS/Include/

STM32_CMSIS_C_SRCs =	$(SRC_DIR)sys/system_stm32f0xx.c

#-------------------------------------------------------------------------------
#						FSM

FSM_C_INCs =			-I$(SRC_DIR)\

FSM_C_SRCs =			$(SRC_DIR)console.c\
						$(SRC_DIR)hsm.c

################################################################################
################		Mock objects		####################################
################################################################################

################################################################################
################		Main		############################################
################################################################################

ROOT_C_INCs =			-I$(INC_DIR)\
						-I$(SRC_DIR)

ROOT_C_SRCs =			$(SRC_DIR)main.c

################################################################################
################		Tests dependencies		################################
################################################################################

TDD_CXX_SRCs +=			$(TESTS_DIR)AllTests.cpp\
						$(TESTS_DIR)dev_test.cpp\
						$(TESTS_DIR)fsm/methods/hsm_build_test.cpp\
						$(TESTS_DIR)fsm/methods/hsm_reset_test.cpp\
						$(TESTS_DIR)fsm/methods/hsm_handleEvent_test.cpp\
						$(TESTS_DIR)fsm/use_case/hsm_1_layer_noEvents_test.cpp\
						$(TESTS_DIR)fsm/use_case/hsm_2_layer_noEvents_test.cpp

################################################################################
################		Assembled dependencies		############################
################################################################################

#-------------------------------------------------------------------------------
#						Host

ifeq ($(PLATFORM),host)
  #	Linux
  ASM_INCs +=
  
  ASM_SRCs +=			

  C_INCs +=				$(ROOT_C_INCs)\
						$(FSM_C_INCs)

  C_SRCs +=				$(ROOT_C_SRCs)\
						$(FSM_C_SRCs)

endif

#-------------------------------------------------------------------------------
#						Target

ifeq ($(PLATFORM),target)
  # ARM
  ASM_INCs +=			

  ASM_SRCs +=			$(CORE_ASM_SRCs)

  C_INCs +=				$(ROOT_C_INCs)\
						$(FSM_C_INCs)\
						$(STM32_CMSIS_C_INCs)

  C_SRCs +=				$(ROOT_C_SRCs)\
						$(FSM_C_SRCs)\
						$(STM32_CMSIS_C_SRCs)
					
endif

#-------------------------------------------------------------------------------
#						Tests

TEST_CXX_INCs += 		$(ROOT_C_INCs)

TEST_CXX_SRCs +=		$(TDD_CXX_SRCs)

TEST_C_INCs +=			$(ROOT_C_INCs)\
						$(FSM_C_INCs)

TEST_C_SRCs +=			$(FSM_C_SRCs)
